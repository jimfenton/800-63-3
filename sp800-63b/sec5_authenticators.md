##5. Authenticator and Verifier Requirements

Section 4 specified the types of authenticators that may be used for each of the three Authenticator Assurance Levels (AALs). This section provides the detailed requirements for each of the authenticator types. With the exception of validation requirements specified in Section 4, the technical requirements for each of the token types is the same regardless of the level at which it is used. For example, a multi-factor cryptographic device may be used at any AAL; the requirements are not different except that validation is not required at AAL 1 and may be asserted by the device's manufacturer at AAL 2.

###5.1. Memorized Secret
A Memorized Secret authenticator (commonly referred to as a *password* or *PIN* if it is numeric) is a secret value that is intended to be chosen and memorizable by the user. Memorized secrets need to be of sufficient complexity and secrecy that it would be impractical for an attacker to guess or otherwise discover the correct secret value.

####5.1.1. Memorized Secret Authenticators

Memorized secrets MUST be at least 8 characters in length. Subscribers should expect that some values for memorized secrets may be disallowed based on their appearance on a blacklist of compromised values. No other complexity requirements for memorized secrets are imposed; a rationale for this is presented in Appendix A.

Claimants authenticating via memorized secrets SHOULD ensure that the communication channel authenticates the Verifier (e.g., using X.509 certificates they trust or can verify) and uses approved encryption (e.g., a current version of TLS) before entering their memorized secret.

####5.1.2. Memorized Secret Verifiers

Verifiers MUST require memorized secrets to be at least 8 characters in length, and MAY impose a higher minimum. Verifiers MUST permit memorized secrets to be at least 64 characters in length. All printing ASCII (ref) characters as well as the space character MUST be acceptable in memorized secrets; Unicode (ref) characters SHOULD be accepted as well.

Memorized secret verifiers MUST NOT permit the subscriber to store a "hint" that is accessible to an unauthenticated claimant. Verifiers also MUST NOT prompt subscribers to use specific types of information (e.g., "What was the name of your first pet?") when choosing memorized secrets.

When processing requests to establish and change memorized secrets, verifiers SHOULD compare the prospective secrets against a dictionary of known commonly-used and/or compromised values. If the chosen secret is found in the dictionary, the subscriber SHOULD be prompted to choose a different value.

Verifiers SHOULD NOT impose other composition rules (mixtures of different character types, for example) on memorized secrets. Verifiers SHOULD NOT require memorized secrets to be changed arbitrarily (e.g., periodically) unless there is evidence of a breach of authentication information.

Verifiers MUST use approved encryption and MUST authenticate themselves to the claimant (e.g., through the use of a X.509 certificate acceptable to the claimant) when requesting memorized secrets in order to provide resistance to eavesdropping and phishing attacks.

Verifiers MUST store memorized secrets in a form that is resistant to offline attacks. Secrets must be hashed with a "salt" value using an approved hash function. The "salt" value MUST be a 32 bit (or longer) random value generated by an approved random number generator and is stored along with the hash result. A keyed hash function (e.g., HMAC), with the key stored separately from the hashed authenticators (e.g., in a hardware security module) SHOULD be used to further resist dictionary attacks against the stored hashed authenticators. ***Say something about hash iterations.***

###5.2. Look-up Secret

A look-up secret authenticator is a physical or electronic record that stores a set of secrets shared between the Claimant and the CSP. The Claimant uses the authenticator to look up the appropriate secret(s) needed to respond to a prompt from the Verifier. For example, a Claimant may be asked by the Verifier to provide a specific subset of the numeric or character strings printed on a card in table format.

####5.2.1 Look-up Secret Authenticators
Look-up secret authenticators (the media and devices containing look-up secrets) MUST be protected by the subscriber against theft or duplication. If the authenticator uses look-up secrets sequentially from a list, the subscriber MAY dispose of used secrets, but only after a successful authentication. The subscriber MUST contact their CSP immediately if theft or duplication of the authenticator is suspected.

CSPs creating look-up secret authenticators MUST use an approved random number generator to generate the list of secrets, and MUST deliver the authenticator securely to the subscriber and to the verifier. ***Describe what delivery methods are acceptable.*** Look-up secrets MUST have at least 64 bits of entropy, or MUST have at least 20 bits of entropy if the number of failed authentication attempts is limited as described in Section 5.2.2.

Claimants authenticating via look-up secrets SHOULD ensure that the communication channel authenticates the Verifier (e.g., using X.509 certificates they trust or can verify) and uses approved encryption (e.g., a current version of TLS) before entering a secret they have looked up.

####5.2.2. Look-up Secret Verifiers

Verifiers of look-up secrets MUST prompt the claimant for the next secret from their authenticator or for a specific (i.e., numbered) secret. A given secret from an authenticator MUST only be used successfully only once; therefore, a given authenticator can only be used for a finite number of successful authentications.

Verifiers MUST store look-up secrets in a form that is resistant to offline attacks. Secrets having less than 64 bits of entropy MUST be hashed with a "salt" value using an approved hash function. The "salt" value MUST be a 32 bit (or longer) random value generated by an approved random number generator and is stored along with the hash result. A keyed hash function (e.g., HMAC), with the key stored separately from the hashed authenticators (e.g., in a hardware security module) SHOULD be used to further resist dictionary attacks against the stored hashed authenticators. Secrets having at least 64 bits of entropy MAY simply be hashed using an approved hash function.

Look-up secrets MUST be generated using an approved random number generator and MUST have at least 20 bits of entropy. When look-up secrets have less than 64 bits of entropy, the verifier MUST implement a throttling mechanism that effectively limits the number of failed authentication attempts an Attacker can make on the Subscriber’s account to 100 or fewer in any 30-day period. See section TBD for further guidance on throttling.

Verifiers MUST use approved encryption and MUST authenticate themselves to the claimant (e.g., through the use of a X.509 certificate acceptable to the claimant) when requesting look-up secrets in order to provide resistance to eavesdropping and phishing attacks.

###5.3. Out of Band

An Out of Band authenticator is a physical device that is uniquely addressable and can receive a Verifier-selected secret for one-time use. The device is possessed and controlled by the Claimant and supports private communication over a secondary channel that is separate from the primary channel for e-authentication. The claimant presents the received secret to the verifier using the primary channel for e-authentication.

***Significant change:*** Two key requirements are that the device be uniquely addressable and that communication over the secondary channel be private. Some of the mechanisms that have been used in the past for out of band authentication, such as mobile telephone text messaging and telephone calls, are no longer considered uniquely addressable since they may be associated with Internet telephony services rather than physical devices. Accordingly, mechanisms such as smartphone applications employing secure communications protocols are required for out-of-band authenticators.

####5.3.1. Out of Band Authenticators
Out of band authenticators MUST be protected by the subscriber against theft or loss. The subscriber MUST contact their CSP immediately if loss or theft of the authenticator is suspected. ***This is getting repetitive -- perhaps goes in lifecycle section?***

Out of band authenticators MUST NOT display the authentication secret on a device that is locked by the owner (i.e., requires an entry of a PIN or passcode). However, authenticators MAY indicate the receipt of an authentication secret on a locked device.

The out of band authenticator MUST establish a secure communication channel with the  verifier that is resistant to man-in-the-middle attacks (e.g., TLS using certificates that are trusted by the authenticator) in order to retrieve the out of band secret. This secure communication channel is considered to be out of band with respect to the primary communication channel, even if they terminate on the same device, provided the device does not leak information from one to the other.

The out of band authenticator MUST uniquely authenticate itself using at least a 124-bit identifying key to the verifier in order to receive the authentication secret. This key SHOULD be stored in the most secure storage available on the device (e.g., keychain storage).

####5.3.2. Out of Band Verifiers

Out of band verifiers MUST generate a random authentication secret with at least 20 bits of entropy using an approved random number generator. They then optionally signal the device containing the subscriber's authenticator to indicate readiness to authenticate.

The verifier then waits for a secure (e.g., TLS) connection from an authenticator and verifies the authenticator's identifying key. The verifier MUST NOT store the identifying key itself, but MUST use a verification method such as hashing (using an approved hash function) or proof of possession of the identifying key to uniquely identify the authenticator. Once authenticated, the verifier transmits the authentication secret to the authenticator and waits for the secret to be returned on the primary communication channel. The authentication secret MUST be considered invalid if not received over the primary channel within 5 minutes.

***Send the website/service name to the authenticator too?***

If the authentication secret has less than 64 bits of entropy, the verifier MUST implement a throttling mechanism that effectively limits the number of failed authentication attempts an Attacker can make on the Subscriber’s account to 100 or fewer in any 30-day period. See section TBD for further guidance on throttling.

###5.4. Single Factor OTP Device

A single factor OTP device is a hardware device that supports the spontaneous generation of one-time passwords. This device has an embedded secret that is used as the seed for generation of one-time passwords and does not require activation through a second factor. Authentication is accomplished by using the authenticator output (i.e., the one-time password) in an authentication protocol, thereby proving possession and control of the device. A one-time password device may, for example, display 6 characters at a time.

Single factor OTP devices are similar to look-up secret authenticators with the exception that the secrets are cryptographically generated by the authenticator and verifier and compared by the verifier. The secret is computed based on a nonce that may be time-based or from a counter on the authenticator and verifier.


###5.5. Multi-Factor OTP Device

A multi-factor OTP device hardware device that generates one-time passwords for use in authentication and which requires activation through a second factor of authentication. The second factor of authentication may be achieved through some kind of integral entry pad, an integral biometric (e.g., fingerprint) reader or a direct computer interface (e.g., USB port) ***Don't understand the USB port***. The one-time password is typically displayed on the device and manually input to the Verifier as a password, although direct electronic input from the device to a computer is also allowed. The authenticator output is the one-time password. For example, a one-time password device may display 6 characters at a time. The MF OTP device is *something you have*, and it may be activated by either *something you know* or *something you are*.
    
###5.6. Single Factor Cryptographic Device

A single-factor cryptographic device is a hardware device that performs cryptographic operations on input provided to the device. This device does not require activation through a second factor of authentication. This device uses embedded symmetric or asymmetric cryptographic keys. Authentication is accomplished by proving possession of the device. The authenticator output is highly dependent on the specific cryptographic device and protocol, but it is generally some type of signed message.
    
###5.7. Multi-Factor Software Cryptographic Authenticator

A multi-factor software cryptographic authenticator is a cryptographic key is stored on disk or some other “soft” media that requires activation through a second factor of authentication. Authentication is accomplished by proving possession and control of the key. The authenticator output is highly dependent on the specific cryptographic protocol, but it is generally some type of signed message. The MF software cryptographic authenticator is *something you have*, and it may be activated by either *something you know* or *something you are*.


###5.8. Multi-Factor Cryptographic Device

A multi-factor cryptographic device is a hardware device that contains a protected cryptographic key that requires activation through a second authentication factor. Authentication is accomplished by proving possession of the device and control of the key. The authenticator output is highly dependent on the specific cryptographic device and protocol, but it is generally some type of signed message. The MF Cryptographic device is *something you have*, and it may be activated by either *something you know* or *something you are*.


